"""
已知一个几乎有序的数组，几乎有序是指，如果把数组排好顺序的话，每个元素移动的距离可以不超过k，并且k相对于数组来说比较小。请选择一个合适的排序算法针对这个数据进行排序。

给定一个int数组A，同时给定A的大小n和题意中的k，请返回排序后的数组。

测试样例：
[2,1,4,3,6,5,8,7,10,9],10,2

返回：[1,2,3,4,5,6,7,8,9,10]
使用改进后的堆排序
"""

class ScaleSort:
    def sortElement(self, A, n, k):
        for i in range(n-k+1):
           self.heapSort(A, i, k)

        #排剩余的k个数
        while i < n:
            k -= 1
            self.heapSort(A, i, k)


    def heapSort(self, A, start, k):
        i = k//2
        while i > 0:
            if i*2+1 <= k and A[i*2+start] < A[i+start-1]:
                A[i * 2+start], A[i+start-1] = A[i+start-1], A[i*2+start]
            if A[i*2-1+start] < A[i+start-1]:
                A[i * 2-1+start], A[i+start-1] = A[i+start-1], A[i * 2-1+start]
            i -= 1
        return A



ss = ScaleSort()
#A = [515,363,354,560,453,15,453,169,84,319,443,536,50,358,356,531,398,277,437,308,495,298,167,86,183,187,503,119,607,314,68,591,12,539,333,23,182,225,47,201,177,362,419,611,144,149,103,57,67,521,343,360,608,78,375,325,195,269,445,293,208,598,529,443,485,351,496,327,496,327,383,122,483,502,492,566,35,84,605,38,264,522,367,398,300,193,164,593,452,451,88,428,330,574,379,20,587,281,356,607,251,226,575,168,106,108,549,405,331,545,492,383,237,501,133,221,364,601,305,198,218,435,186,279,295,542,90,255,474,327,87,501,33,549,538,412,464,137,93,89,353,31,329,4,452,548,615,231,142,418,335,193,195,384,125,464,320,434,586,68,125,76,347,398,351,107,73,538,310,116,446,564,461,416,258,330,145,523,545,520,459,190,134,109,211,516,409,281,219,340,592,426,492,421,119,217,216,64,344,113,214,164,212,335,420,374,113,334,387,269,159,531,187,532,469,172,100,330,183,230,51,213,257,144,406,42,76,400,92,584,131,580,95,345,259,594,276,130,171,4,449,337,242,462,276,301,278,11,40,268,345,595,402,367,304,434,210,11,497,593]
#A = [2,1,4,3,6,5,8,7,10,9]
A = [515,363,354,560,453,15,453,169,84,319,443,536,50,358,\
     356,531,398,277,437,308,495,298,167,86,183,187,503,119,607,314,
     68,591,12,539,333,23,182,225,47,201,177,362,419,611,144,149,103,57,67,521,
     343,360,608,78,375,325,195,269,445,293,208,598,529,443,485,351,496,327,496,327,
     383,122,483,502,492,566,35,84,605,38,264,522,367,398,300,193,164,593,452,451,
     88,428,330,574,379,20,587,281,356,607,251,226,575,168,106,108,549,405,331,545,492,
     383,237,501,133,221,364,601,305,198,218,435,186,279,295,542,90,255,474,327,87,501,33,
     549,538,412,464,137,93,89,353,31,329,4,452,548,615,231,142,418,335,193,195,384,125,464,
     320,434,586,68,125,76,347,398,351,107,73,538,310,116,446,564,461,416,258,330,145,523,545,
     520,459,190,134,109,211,516,409,281,219,340,592,426,492,421,119,217,216,64,344,113,214,
     164,212,335,420,374,113,334,387,269,159,531,187,532,469,172,100,330,183,230,51,213,
     257,144,406,42,76,400,92,584,131,580,95,345,259,594,276,130,171,4,449,337,242,462,276,
     301,278,11,40,268,345,595,402,367,304,434,210,11,497,593,243,19,312,282,415,136,38,
     365,512,596,476,158,320,477,519,146,383,285,106,374,16,472,261,557,53,65,187,46,176,
     19,421,358,461,461,348,597,551,507,352,64,350,579,183,555,500,166,484,581,495,600,
     107,223,280,493,235,280,103,593,268,487,95,89,43,479,549,309,216,347,194,284,6,345,
     271,3,486,331,444,118,191,554,573,444,276,560,382,78,316,177,244,135,600,213,207,
     190,311,505,262,421,495,376,503,238,89,508,404,251,303,0,446,262,547,139,508,483,517,414,101,241,191,134,17,23,120,2,151,559,326,91,323,247,435,449,126,347,244,254,364,522,302,84,99,4,527,108,293,466,417,67,87,397,501,1221,959,1117,958,682,649,787,889,615,681,1217,896,1005,1047,1122,855,1083,1261,1211,832,1063,822,764,1211,844,647,1083,870,1100,671,722,1243,1083,625,1062,1073,617,1221,803,971,637,928,1068,1181,733,1256,1226,1124,673,992,
     739,794,765,828,715,1254,1218,961,914,806,859,668,773,805,1102,1037,
     616,948,967,1208,852,1169,981,1267,1168,1019,1074,994,674,884,1082,891,671,743,1150,1061,719,622,1242,644,1229,1236,1198,1087,925,1040,976,658,839,1191,1085,1222,842,679,1129,1056,620,1025,985,826,714,1144,844,814,981,1198,874,685,617,857,665,977,1202,1204,633,1245,1072,1256,824,857,718,988,811,1001,765,677,727,1088,939,968,987,1002,1104,668,1079,884,1146,694,774,657,1203,1193,
     639,628,1132,815,1264,970,807,756,855,681,964,1109,886,916,806,1224,1021,703,1272,1035,1083,1049,970,919,1160,1272,
     662,737,1141,1267,791,633,719,874,1114,746,1125,865,794,1066,
     1105,932,1029,834,905,1053,730,932,904,850,991,787,1267,1239,957,1047,953,1051,766,1133,704,814,829,1018,735,768,1104,664,755,1231,1067,630,991,1041,943,698,1138,876,1166,763,638,678,1261,791,1004,627,1030,676,1269,633,1232,885,1023,748,740,627,682,804,803,1134,712,1091,891,1114,1148,1045,1006,821,1129,841,
     1060,680,817,1197,1130,1135,1188,737,1238,864,1029,1145,640,1014,
     903,803,704,1171,1050,680,999,808,784,752,804,828,781,816,954,985,1071,802,1152,620,1263,943,703,1191,698,1003,622,1127,805,1012,939,885,1130,1241,1216,1115,956,920,625,727,950,992,1027,995,928,620,772,942,983,665,1144,766,729,1254,628,963,1037,713,832,848,1211,637,1215,1207,704,751,665,1054,747,1167,917,1083,705,1188,1120,851,817,733,867,867,1163,676,1151,716,894,645,709,1262,1143,713,729,808,1096,916,644,1262,990,886,965,710,749,1044,1191,1245,790,921,1081,868,904,1020,1168,668,731,
     1173,783,751,917,1018,1219,1043,695,833,823,1248,904,965,1100,783,930,841,1253,746,845,634,1254,1784,1536,1528,1342,1309,1336,1406,1701,1653,1866,1286,1848,1437,1524,1277,1596,1727,1411,1313,1284,1508,1426,1363,1455,1492,1696,1494,1751,1276,1424,1404,1414,1465,1622,1283,1330,1618,1579,1762,1381,1468,1327,1338,1386,1469,1537,1492,1464,1565,1878,1347,1425,1771,1369,1667,1548,1442,1703,
     1737,1763,1727,1506,1512,1675,1804,1454,1580,1830,1443,1563,1648,1659,1832,1307,1574,1666,1663,1516,1274,
     1369,1837,1487,1434,1601,1856,1487,1391,1426,1276,1672,1375,1848,1497,1294,1765,1575,1733,1491,1546,1626,1439,1439,1518,1692,1672,1670,1281,1461,1849,1762,1724,1403,1622,
     1763,1465,1526,1468,1882,1372,1765,1307,1384,1548,1763,1645,1491,1447,1760,1772,1311,1726,1292,1812,1577,1687,1750,1697,1757,1773,1739,1725,1515,1396,1762,1634,1466,1347,1364,1651,1326,1701,1629,1739,1502,1414,1717,1799,1809,1772,1755,1531,1676,1705,1494,1605,1605,1542,1340,1643,1857,1737,1890,1808,1517,1432,1441,1454,1641,1660,1427,1407,1382,1585,1333,1714,1709,1745,1287,1685,1542,1768,
     1335,1636,1592,1305,1762,1579,1589,1693,1415,1452,1814,1877,1365,1804,1440,1625,
     1539,1387,1745,1784,1415,1490,1764,1768,1443,1653,1301,1692,1697,1354,1509,1878,1508,1424,1678,1669,1386,
     1508,1855,1538,1370,1291,1751,1436,1660,1276,1663,1325,1876,1358,1527,1739,1795,1645,1482,1433,1618,
     1618,1652,1838,1314,1675,1539,1307,1277,1715,1866,1342,1855,1426,1643,1590,1693,1551,1678,1543,1324,1583,1344,1671,1313,1807,1805,1886,1868,1644,1448,1480,1448,1516,1712,
     1826,1289,1539,1520,1888,1703,1589,1697,1480,1436,1649,1679,1890,1527,1302,1582,1867,1341,1698,1274,1500,1510,1476,1576,1302,1520,1754,1647,1401,1727,1581,1337,1562,1530,1664,1314,1797,1864,1735,1306,1371,1693,1618,1499,1288,1569,1628,1380,1796,1455,1346,1825,1345,1545,1573,1547,1417,1759,
     1817,1794,1355,1595,1412,1506,1567,1747,1312,1680,1610,1387,1350,1407,1371,1747,1798,
     1378,1874,1493,1533,1703,1698,1284,1807,1793,1509,1659,1588,1803,1729,1793,1396,1561,
     1850,1388,1306,1653,1708,1779,1828,1698,1694,1811,1581,1298,1529,1385,1647,1316,1396,1711,
     1485,1325,1834,1726,1709,1807,1834,1832,1702,1639,1383,1477,1518,1359,1616,1583,1337,1533,1306,2452,2225,2255,2361,2312,2190,2038,2521,
     1935,2215,1942,2416,2339,1925,2111,2280,1977,2424,2165,2062,2288,2242,2056,2529,2138,2223,2220,1905,2165,2445,2499,1956,2140,2529,2125,2421,1981,1978,1946,2260,2018,2485,2400,2480,2293,2099,2036,2257,2043,1908,2039,2301,2405,1932,1983,1943,2314,
     2298,2271,2302,1994,2325,2437,2283,2230,1984,2462,1896,2168,2365,2115,2016,1891,2296,2001,2404,2310,2151,2027,2391,2140,2009,2299,2512,1976,2274,1983,2248,2275,2544,2380,1913,2293,2046,1980,2250,2443,2390,1934,2167,1893,2463,1997,1952,2176,2387,
     2479,2103,1934,2307,2174,2232,2167,1937,2333,2534,2533,2498,1892,2398,2030,2293,2146,2415,2035,2196,2289,1929,1925,2011,2178,2041,2142,2193,2213,2502,2523,
     2042,2051,2547,2163,2241,2019,1917,2481,2433,2121,2161,1967,2305,2306,2087,2438,2437,2313,2377,2545,2470,2158,2076,2260,2447,2419,2004,2096,2071,2485,2382,2506,2007,2357,2177,2496,2124,2146,1982,2012,2213,2177,2431,2415,2386,2350,2030,1900,2229,1957,2436,2130,2186,2080,2370,2281,1898,2130,2491,1950,2123,2291,1916,2079,2117,2376,1890,2433,2176,
     2142,2028,2185,2088,2066,2381,2414,2435,2169,2355,2112,1990,
     2114,1961,2144,2051,2009,2027,2176,2283,2100,2187,2237,1978,2496,1960,2427,2041,1987,1947,2004,2499,2389,2342,2261,2063,2471,2437,2138,2091,2361,2315,2040,2239,2115,1972,2486,2420,2199,2542,2346,2006,1977,2287,2083,2362,2278,2347,2427,2020,2068,2401,1941,2180,2023,2087,1996,2173,2294,2272,2445,2271,2032,2233,2156,
     2479,1950,2353,2241,2264,2061,2099,2330,2246,1903,2306,2163,1923,2164,1905,2091,2108,2023,2018,2366,2364,2128,2325,2134,1989,2450,
     2145,2533,2093,1998,2013,1975,2016,1970,1897,2053,2297,2454,2047,2107,2454,2419,2189,2119,2031,2134,2513,2101,1912,1904,2520,2333,2432,2165,2434,2023,2074,2262,2000,2023,2314,2497,2377,2485,2548]
print(ss.sortElement(A,243, 500))


